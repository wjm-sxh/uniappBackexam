import{a as $,l as G,j as g,o as v,c as f,g as l,m as p,p as y,e as r,F as b,A as E,i as x,t as q,B as A,s as H,E as K,v as D,C as I,D as L,x as P}from"./index-PsrkDi4f.js";/* empty css                 */import"./el-scrollbar-BVndcwmd.js";import{E as Q,a as W}from"./el-select-lkdsic8F.js";import{i as X,e as Y}from"./request-aijzG6J_.js";import{E as _}from"./index-2NzJ_tzg.js";import{E as Z}from"./index-B8WeAn_N.js";import"./isEqual-CJgsbmic.js";const ee={class:"topic-form"},le={class:"form"},oe={class:"opt"},te={class:"opt"},se={class:"opt"},ne={class:"opt"},ae=["onUpdate:modelValue"],ie=["onUpdate:modelValue"],re={class:"opt"},pe={class:"opt"},de={class:"opt"},ue={class:"opt"},be=$({__name:"Topic",setup(me){let s=G({eid:"",name:"",question:"",answer:"",score:0,id:"",option:""}),k=g([]),U=g([]),C=g([]),z=g({num:0}),B=g(0),c=g([{op:"A",ov:""},{op:"B",ov:""},{op:"C",ov:""},{op:"D",ov:""}]),d=c.value.length-1;const N=()=>{d++,d<4&&c.value.push({op:"",ov:""}),d=d==4?4:d},T=t=>{d--,d>=0&&(d=0),c.value.splice(t,1)},F=()=>{let t=c.value;if(t&&t.length!=0){let e=[];for(let a=0;a<t.length;a++){let i={};i.key=t[a].op,i.value=t[a].ov&&t[a].ov.replace(/\"/g,"”"),e.push(i)}let n=e&&JSON.stringify(e);s.option=n}},S=t=>{let e=U.value.filter(n=>n.id==t);C.value=e,s.eid=""},M=async t=>{console.log("eid:",t);let e=C.value.filter(n=>n.eid==t);e.length==1&&(z.value=e[0],s.score=e[0].score,s.name=e[0].name),t&&await A.topicNum({eid:t}).then(n=>{console.log(n);let{code:a,result:i}=n;a==200&&(B.value=i[0].total)},n=>{console.log(n)})},h=async()=>{s.eid="",s.name="",s.question="",s.answer="",s.score=0,s.option="",s.id="",c.value=[{op:"A",ov:""},{op:"B",ov:""},{op:"C",ov:""},{op:"D",ov:""}]},j=async()=>{let{eid:t,name:e,question:n,answer:a,score:i,option:u}=s;t&&e&&n&&a&&i&&u?A.topicAdd({eid:t,name:e,question:n,answer:a,score:i,option:u}).then(m=>{let{code:V,msg:o}=m;V==200?(h(),_.success(o)):_.error(o)},m=>{console.log(m)}):_.error("缺少参数，请重新提交")},O=async()=>{await X().then(t=>{let{code:e,msg:n,result:a}=t;if(e==200){let i=a.map((u,m)=>(u.yid=m+1,u));U.value=i}else _.error(n)})},R=async()=>{await Y().then(t=>{let{code:e,result:n}=t;if(e==200){let a=n.map(i=>(i.xid=Math.random().toString().slice(2),i));k.value=a}})};return O(),R(),(t,e)=>{const n=W,a=Q,i=Z,u=H("Remove"),m=P,V=K;return v(),f(b,null,[e[17]||(e[17]=l("h3",null,"题目管理",-1)),l("div",ee,[l("div",le,[l("div",oe,[e[5]||(e[5]=l("span",{class:"label"},"考试分类:",-1)),p(a,{onChange:S,modelValue:r(s).id,"onUpdate:modelValue":e[0]||(e[0]=o=>r(s).id=o),placeholder:"选择分类",style:{width:"640px"},size:"large"},{default:y(()=>[(v(!0),f(b,null,E(r(k),o=>(v(),D(n,{key:o.xid,label:o.text,value:o.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),l("div",te,[e[6]||(e[6]=l("span",{class:"label"},"试卷名称:",-1)),p(a,{onChange:M,modelValue:r(s).eid,"onUpdate:modelValue":e[1]||(e[1]=o=>r(s).eid=o),placeholder:"选择试卷",style:{width:"640px"},size:"large"},{default:y(()=>[(v(!0),f(b,null,E(r(C),o=>(v(),D(n,{key:o.yid,label:o.name,value:o.eid},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),l("div",se,[e[7]||(e[7]=l("span",{class:"label"},"题目:",-1)),p(i,{modelValue:r(s).question,"onUpdate:modelValue":e[2]||(e[2]=o=>r(s).question=o),style:{width:"640px"},placeholder:"请输入题目",size:"large"},null,8,["modelValue"])]),l("div",ne,[e[8]||(e[8]=l("span",{class:"label top"},"选项:",-1)),l("ul",null,[(v(!0),f(b,null,E(r(c),(o,J)=>(v(),f("li",null,[I(l("input",{onInput:F,class:"op","onUpdate:modelValue":w=>o.op=w,type:"text",placeholder:"",maxlength:"1"},null,40,ae),[[L,o.op]]),I(l("input",{onInput:F,class:"ov","onUpdate:modelValue":w=>o.ov=w,type:"text",placeholder:"请输入选项"},null,40,ie),[[L,o.ov]]),p(m,{size:"large",onClick:w=>T(J)},{default:y(()=>[p(u)]),_:2},1032,["onClick"])]))),256)),l("li",null,[l("button",{class:"btn",onClick:N},"新增选项")])])]),l("div",re,[e[9]||(e[9]=l("span",{class:"label"},"答案:",-1)),p(i,{modelValue:r(s).answer,"onUpdate:modelValue":e[3]||(e[3]=o=>r(s).answer=o),style:{width:"640px"},placeholder:"请输入答案",size:"large"},null,8,["modelValue"])]),l("div",pe,[e[10]||(e[10]=l("span",{class:"label"},"分值:",-1)),p(i,{modelValue:r(s).score,"onUpdate:modelValue":e[4]||(e[4]=o=>r(s).score=o),style:{width:"640px"},placeholder:"分值",size:"large"},null,8,["modelValue"])]),l("div",de,[e[11]||(e[11]=l("span",{class:"label"},"数量信息:",-1)),e[12]||(e[12]=x(" 【 ")),l("span",null,q(r(z).num),1),e[13]||(e[13]=x(" / ")),l("span",null,q(r(B)),1),e[14]||(e[14]=x(" 】 "))]),l("div",ue,[p(V,{onClick:j,type:"primary",size:"large"},{default:y(()=>e[15]||(e[15]=[x("提交题目")])),_:1}),p(V,{onClick:h,type:"warning",plain:"",size:"large"},{default:y(()=>e[16]||(e[16]=[x("重置")])),_:1})])])]),e[18]||(e[18]=l("div",{class:"topic-list"},null,-1))],64)}}});export{be as default};
