import{a as k,j as _,l as U,z as L,o as x,c as E,g as s,m as o,p as m,F as h,E as F,A,v as N,i as b}from"./index-PsrkDi4f.js";import{E as P,a as $}from"./el-table-column-DxxjLTlZ.js";import"./el-scrollbar-BVndcwmd.js";/* empty css                 */import{E as j,a as D}from"./el-select-lkdsic8F.js";import{h as M,i as I,e as O,j as R}from"./request-aijzG6J_.js";import{E as u}from"./index-2NzJ_tzg.js";import{E as S}from"./index-B8WeAn_N.js";import{E as q}from"./index-CNT-Lsf8.js";import"./isEqual-CJgsbmic.js";import"./_initCloneObject-9ZjZV-aK.js";const G={class:"test-form"},H={class:"opt"},J={class:"opt"},K={class:"opt"},Q={class:"opt"},W={class:"opt"},X={class:"opt"},Y={class:"opt"},Z={class:"opt"},ee={class:"category-table"},ce=k({__name:"TestPaper",setup(le){const c=_([]),g=_([]),l=U({id:"",text:"",name:"",time:2,total:100,passline:60,num:0,score:0});L(l,a=>{a.total&&a.num&&(l.score=a.total/a.num)});const V=()=>{l.id="",l.text="",l.name="",l.total=100,l.passline=60,l.time=2,l.num=0,l.score=0},C=async()=>{let{id:a,text:e,name:r,total:p,passline:i,time:d,num:n,score:f}=l;a&&e&&r&&p&&i&&d?await M({id:a,text:e,name:r,total:p,passline:i,time:d,num:n,score:f}).then(t=>{let{code:w,msg:y}=t;w==200?(v(),V(),u.success(y)):u.error(y)},t=>{console.log(t)}):u.error("缺少参数，请检查在提交")},v=async()=>{await I().then(a=>{let{code:e,msg:r,result:p}=a;if(e==200){let i=p.map((d,n)=>(d.index=n+1,d));c.value=i}else u.error(r)})},z=()=>{let a=g.value.filter(e=>e.id==l.id);a.length==1&&(l.text=a[0].text),console.log(l.id),console.log(l.text)},B=async()=>{await O().then(a=>{let{code:e,result:r}=a;e==200&&(g.value=r)})},T=(a,e)=>{let{eid:r,name:p}=e;q.confirm(`是否删除这个“${p}”试卷?`,"提示",{distinguishCancelAndClose:!0,confirmButtonText:"确定",cancelButtonText:"取消"}).then(async()=>{await R({eid:r}).then(i=>{let{code:d,msg:n}=i;d!=200&&u.error(n)}),c.value.splice(a,1)}).catch(()=>{})};return B(),v(),(a,e)=>{const r=D,p=j,i=S,d=F,n=$,f=P;return x(),E(h,null,[e[17]||(e[17]=s("h3",null,"试卷管理",-1)),s("div",G,[s("div",H,[e[7]||(e[7]=s("span",{class:"label"},"分类:",-1)),o(p,{onChange:z,modelValue:l.id,"onUpdate:modelValue":e[0]||(e[0]=t=>l.id=t),style:{width:"360px"},placeholder:"请输入考试分类",size:"large"},{default:m(()=>[(x(!0),E(h,null,A(g.value,t=>(x(),N(r,{label:t.text,value:t.id},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])]),s("div",J,[e[8]||(e[8]=s("span",{class:"label"},"试卷:",-1)),o(i,{modelValue:l.name,"onUpdate:modelValue":e[1]||(e[1]=t=>l.name=t),style:{width:"360px"},placeholder:"请输入试卷名称",size:"large"},null,8,["modelValue"])]),s("div",K,[e[9]||(e[9]=s("span",{class:"label"},"总分:",-1)),o(i,{modelValue:l.total,"onUpdate:modelValue":e[2]||(e[2]=t=>l.total=t),style:{width:"360px"},placeholder:"总分",size:"large"},null,8,["modelValue"])]),s("div",Q,[e[10]||(e[10]=s("span",{class:"label"},"及格:",-1)),o(i,{modelValue:l.passline,"onUpdate:modelValue":e[3]||(e[3]=t=>l.passline=t),style:{width:"360px"},placeholder:"及格线",size:"large"},null,8,["modelValue"])]),s("div",W,[e[11]||(e[11]=s("span",{class:"label"},"考试时长:",-1)),o(i,{modelValue:l.time,"onUpdate:modelValue":e[4]||(e[4]=t=>l.time=t),style:{width:"360px"},placeholder:"考试时长",size:"large"},null,8,["modelValue"])]),s("div",X,[e[12]||(e[12]=s("span",{class:"label"},"题目数量:",-1)),o(i,{modelValue:l.num,"onUpdate:modelValue":e[5]||(e[5]=t=>l.num=t),style:{width:"360px"},placeholder:"考试时长",size:"large"},null,8,["modelValue"])]),s("div",Y,[e[13]||(e[13]=s("span",{class:"label"},"题目分值:",-1)),o(i,{modelValue:l.score,"onUpdate:modelValue":e[6]||(e[6]=t=>l.score=t),style:{width:"360px"},placeholder:"考试时长",size:"large"},null,8,["modelValue"])]),s("div",Z,[o(d,{onClick:C,type:"primary",size:"large"},{default:m(()=>e[14]||(e[14]=[b("提交")])),_:1}),o(d,{onClick:V,type:"warning",plain:"",size:"large"},{default:m(()=>e[15]||(e[15]=[b("重置")])),_:1})])]),s("div",ee,[o(f,{data:c.value,stripe:"",style:{width:"100%"}},{default:m(()=>[o(n,{prop:"index",label:"序号",width:"50"}),o(n,{prop:"text",label:"分类",width:"180"}),o(n,{prop:"name",label:"试卷名称",width:"180"}),o(n,{prop:"total",label:"总分",width:"80"}),o(n,{prop:"passline",label:"及格线",width:"80"}),o(n,{prop:"time",label:"时长(小时)",width:"100"}),o(n,{prop:"num",label:"题目数量(个)",width:"150"}),o(n,{prop:"score",label:"分值(分)",width:"100"}),o(n,{label:"操作"},{default:m(t=>[o(d,{size:"small",type:"danger",onClick:w=>T(t.$index,t.row)},{default:m(()=>e[16]||(e[16]=[b(" 删除 ")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])])],64)}}});export{ce as default};
