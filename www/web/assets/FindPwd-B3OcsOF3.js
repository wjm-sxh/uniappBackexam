import{d as N,h as S,r as g,c as U,a as s,i as p,v as r,t as $,u as q,b as _,w as V,k as B,l as d,p as D,m as h,f as E,o as I,g as x}from"./index-BxMPK5Cm.js";import{r as v}from"./request-Ci6WhDJZ.js";const P={class:"findpwd"},j={class:"form"},M={class:"opt"},R={class:"opt opt-2"},z={class:"opt"},A={class:"opt"},G={class:"opt"},H={class:"bottom"},O=N({__name:"FindPwd",setup(J){const f=B(),T=()=>{f.push({path:"/home/category"})},t=S({account:"",password2:"",password:"",vcode:""}),k=async()=>{let{account:a,vcode:e,password:l,password2:o}=t;if(a&&l&&o&&e){let b=!1;await v.emailVerify({email:a,vcode:e}).then(c=>{let{code:y,msg:m}=c;y==200?b=!0:d(m)}),b&&(l!=o?d("两次输入密码不一致"):await v.findpwd({account:a,password:l}).then(c=>{let{msg:y,code:m}=c;m==200?(D("设置密码成功"),setTimeout(()=>{f.replace({path:"/login"})},150)):h("设置密码失败")}))}else d("缺少参数，请重新填写")};let i=g("发送邮箱验证码"),n=g(60),u=!0,w=null;const C=()=>{n.value--,i.value=`${n.value}秒后重新发送`,w=setInterval(()=>{n.value--,i.value=`${n.value}秒后重新发送`,n.value==0&&(clearInterval(w),i.value="点击重新发送",u=!0,n.value=60)},1e3)},F=async()=>{let a=t.account;a.length!=0?/\w+@qq.com$/.test(a)?u&&(u=!1,C(),await v.emailSend({email:a}).then(e=>{let{msg:l}=e;d(l)})):d("邮箱格式不正确"):h("请输入账号")};return(a,e)=>{const l=E("van-button");return I(),U("div",P,[s("div",j,[s("div",M,[e[4]||(e[4]=s("span",{class:"label"},"账号/邮箱:",-1)),p(s("input",{"onUpdate:modelValue":e[0]||(e[0]=o=>t.account=o),type:"text",placeholder:"请输入账号/邮箱"},null,512),[[r,t.account]])]),s("div",R,[e[5]||(e[5]=s("span",{class:"label"},"验证码:",-1)),p(s("input",{"onUpdate:modelValue":e[1]||(e[1]=o=>t.vcode=o),type:"text",placeholder:"请输入密码"},null,512),[[r,t.vcode]]),s("button",{onClick:F,class:"btn-send"},$(q(i)),1)]),s("div",z,[e[6]||(e[6]=s("span",{class:"label"},"新密码:",-1)),p(s("input",{"onUpdate:modelValue":e[2]||(e[2]=o=>t.password=o),type:"password",placeholder:"请输入密码"},null,512),[[r,t.password]])]),s("div",A,[e[7]||(e[7]=s("span",{class:"label"},"确认密码:",-1)),p(s("input",{"onUpdate:modelValue":e[3]||(e[3]=o=>t.password2=o),type:"password",placeholder:"请确认密码"},null,512),[[r,t.password2]])]),s("div",G,[_(l,{onClick:k,class:"btn-login",type:"default"},{default:V(()=>e[8]||(e[8]=[x("保存")])),_:1})])]),s("div",H,[_(l,{onClick:T,type:"default",plain:"",color:"#cccccc"},{default:V(()=>e[9]||(e[9]=[x("首页")])),_:1})])])}}});export{O as default};
