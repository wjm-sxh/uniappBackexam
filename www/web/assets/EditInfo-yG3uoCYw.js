import{d as T,r as U,h as C,c as E,a as s,b as r,w as f,i as u,v as m,F,k as S,l as v,p as z,m as B,f as g,o as D,g as _}from"./index-BxMPK5Cm.js";import{r as c}from"./request-Ci6WhDJZ.js";const R={class:"header"},M={class:"edit"},O={class:"opt opt-1"},$={class:"opt opt-1"},q={class:"opt opt-2"},A=["disabled"],G={class:"opt opt-2"},K=["disabled"],L={class:"opt opt-2"},j=["disabled"],H={class:"opt opt-2"},J=["disabled"],P={class:"opt opt-2"},Q=["disabled"],W={class:"opt opt-1"},se=T({__name:"EditInfo",setup(X){const k=S(),b=new FormData,y=a=>{b.append("photo",a.file)};let p=localStorage.getItem("AUTOTOKEN");const x=U([{url:localStorage.getItem("USERIMG")}]),w=async()=>{if(p==null)return!1;let a;await c.photoUpload(b).then(e=>{console.log(e);let{code:o,msg:i,picUrl:n}=e;o==200?a=n:v(i)}),a&&await c.userImg({token:p,imgUrl:a}).then(e=>{let{msg:o}=e;v(o)})},V=()=>{k.go(-1)},d=U(!0),t=C({});(async()=>{c.userInfo({token:p}).then(a=>{let{code:e,result:[o]}=a;e==200&&(t.phone=o.phone,t.address=o.address,t.sex=o.sex,t.age=o.age,t.nickName=o.nickName)})})();const I=async()=>{let{age:a,sex:e,address:o,phone:i,nickName:n}=t;p&&(a&&e&&o&&i?c.userEdit({token:p,age:a,sex:e,address:o,phone:i,nickName:n}).then(l=>{let{msg:h,code:N}=l;N==200?z("保存成功"):B(h)}):v("输入框不能为空"))};return(a,e)=>{const o=g("van-icon"),i=g("van-uploader"),n=g("van-button");return D(),E(F,null,[s("div",R,[r(o,{name:"arrow-left",onClick:V})]),s("div",M,[s("div",O,[r(i,{modelValue:x.value,"onUpdate:modelValue":e[0]||(e[0]=l=>x.value=l),"max-count":1,"after-read":y},null,8,["modelValue"])]),s("div",$,[r(n,{onClick:w,plain:"",type:"success",size:"small"},{default:f(()=>e[7]||(e[7]=[_("保存头像")])),_:1})]),s("div",q,[e[8]||(e[8]=s("span",{class:"label"},"昵称：",-1)),u(s("input",{type:"text","onUpdate:modelValue":e[1]||(e[1]=l=>t.nickName=l),class:"inp",disabled:d.value,placeholder:"请输入昵称"},null,8,A),[[m,t.nickName]])]),s("div",G,[e[9]||(e[9]=s("span",{class:"label"},"电话：",-1)),u(s("input",{type:"text","onUpdate:modelValue":e[2]||(e[2]=l=>t.phone=l),class:"inp",disabled:d.value,placeholder:"请输入电话"},null,8,K),[[m,t.phone]])]),s("div",L,[e[10]||(e[10]=s("span",{class:"label"},"年龄：",-1)),u(s("input",{type:"text","onUpdate:modelValue":e[3]||(e[3]=l=>t.age=l),class:"inp",disabled:d.value,placeholder:"请输入年龄"},null,8,j),[[m,t.age]])]),s("div",H,[e[11]||(e[11]=s("span",{class:"label"},"性别：",-1)),u(s("input",{type:"text","onUpdate:modelValue":e[4]||(e[4]=l=>t.sex=l),class:"inp",disabled:d.value,placeholder:"请输入性别"},null,8,J),[[m,t.sex]])]),s("div",P,[e[12]||(e[12]=s("span",{class:"label"},"地址：",-1)),u(s("input",{type:"text","onUpdate:modelValue":e[5]||(e[5]=l=>t.address=l),class:"inp",disabled:d.value,placeholder:"请输入地址"},null,8,Q),[[m,t.address]])]),s("div",W,[r(n,{onClick:e[6]||(e[6]=l=>d.value=!1),plain:"",type:"warning",size:"small"},{default:f(()=>e[13]||(e[13]=[_("编辑")])),_:1}),r(n,{onClick:I,style:{"margin-left":"10px"},plain:"",type:"success",size:"small"},{default:f(()=>e[14]||(e[14]=[_("保存修改")])),_:1})])])],64)}}});export{se as default};
