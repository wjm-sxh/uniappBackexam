import{d as k,r as _,ac as U,a3 as L,o as x,c as E,a as o,b as s,w as m,Q as h,E as F,R as N,G as P,e as b}from"./index-BU7Eo9xm.js";import{E as $,a as A}from"./el-table-column-CVZQr0T1.js";import"./el-scrollbar-Cjw3bkZt.js";/* empty css                 */import{E as D,a as M}from"./el-select-kkF33hGk.js";import{e as R,f as G,b as I,g as O}from"./request-DCHLsrwf.js";import{E as u}from"./index-CZzwatfY.js";import{E as Q}from"./index-COtfk0Lf.js";import{E as S}from"./index-CEuKtwGG.js";const j={class:"test-form"},q={class:"opt"},H={class:"opt"},J={class:"opt"},K={class:"opt"},W={class:"opt"},X={class:"opt"},Y={class:"opt"},Z={class:"opt"},ee={class:"category-table"},me=k({__name:"TestPaper",setup(le){const c=_([]),f=_([]),l=U({id:"",text:"",name:"",time:2,total:100,passline:60,num:0,score:0});L(l,a=>{a.total&&a.num&&(l.score=a.total/a.num)});const V=()=>{l.id="",l.text="",l.name="",l.total=100,l.passline=60,l.time=2,l.num=0,l.score=0},C=async()=>{let{id:a,text:e,name:r,total:p,passline:i,time:d,num:n,score:g}=l;a&&e&&r&&p&&i&&d?await R({id:a,text:e,name:r,total:p,passline:i,time:d,num:n,score:g}).then(t=>{let{code:v,msg:y}=t;v==200?(w(),V(),u.success(y)):u.error(y)},t=>{console.log(t)}):u.error("缺少参数，请检查在提交")},w=async()=>{await G().then(a=>{let{code:e,msg:r,result:p}=a;if(e==200){let i=p.map((d,n)=>(d.index=n+1,d));c.value=i}else u.error(r)})},z=()=>{let a=f.value.filter(e=>e.id==l.id);a.length==1&&(l.text=a[0].text),console.log(l.id),console.log(l.text)},B=async()=>{await I().then(a=>{let{code:e,result:r}=a;e==200&&(f.value=r)})},T=(a,e)=>{let{eid:r,name:p}=e;S.confirm(`是否删除这个“${p}”试卷?`,"提示",{distinguishCancelAndClose:!0,confirmButtonText:"确定",cancelButtonText:"取消"}).then(async()=>{await O({eid:r}).then(i=>{let{code:d,msg:n}=i;d!=200&&u.error(n)}),c.value.splice(a,1)}).catch(()=>{})};return B(),w(),(a,e)=>{const r=M,p=D,i=Q,d=F,n=A,g=$;return x(),E(h,null,[e[17]||(e[17]=o("h3",null,"试卷管理",-1)),o("div",j,[o("div",q,[e[7]||(e[7]=o("span",{class:"label"},"分类:",-1)),s(p,{onChange:z,modelValue:l.id,"onUpdate:modelValue":e[0]||(e[0]=t=>l.id=t),style:{width:"360px"},placeholder:"请输入考试分类",size:"large"},{default:m(()=>[(x(!0),E(h,null,N(f.value,t=>(x(),P(r,{label:t.text,value:t.id},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])]),o("div",H,[e[8]||(e[8]=o("span",{class:"label"},"试卷:",-1)),s(i,{modelValue:l.name,"onUpdate:modelValue":e[1]||(e[1]=t=>l.name=t),style:{width:"360px"},placeholder:"请输入试卷名称",size:"large"},null,8,["modelValue"])]),o("div",J,[e[9]||(e[9]=o("span",{class:"label"},"总分:",-1)),s(i,{modelValue:l.total,"onUpdate:modelValue":e[2]||(e[2]=t=>l.total=t),style:{width:"360px"},placeholder:"总分",size:"large"},null,8,["modelValue"])]),o("div",K,[e[10]||(e[10]=o("span",{class:"label"},"及格:",-1)),s(i,{modelValue:l.passline,"onUpdate:modelValue":e[3]||(e[3]=t=>l.passline=t),style:{width:"360px"},placeholder:"及格线",size:"large"},null,8,["modelValue"])]),o("div",W,[e[11]||(e[11]=o("span",{class:"label"},"考试时长:",-1)),s(i,{modelValue:l.time,"onUpdate:modelValue":e[4]||(e[4]=t=>l.time=t),style:{width:"360px"},placeholder:"考试时长",size:"large"},null,8,["modelValue"])]),o("div",X,[e[12]||(e[12]=o("span",{class:"label"},"题目数量:",-1)),s(i,{modelValue:l.num,"onUpdate:modelValue":e[5]||(e[5]=t=>l.num=t),style:{width:"360px"},placeholder:"考试时长",size:"large"},null,8,["modelValue"])]),o("div",Y,[e[13]||(e[13]=o("span",{class:"label"},"题目分值:",-1)),s(i,{modelValue:l.score,"onUpdate:modelValue":e[6]||(e[6]=t=>l.score=t),style:{width:"360px"},placeholder:"考试时长",size:"large"},null,8,["modelValue"])]),o("div",Z,[s(d,{onClick:C,type:"primary",size:"large"},{default:m(()=>e[14]||(e[14]=[b("提交")])),_:1}),s(d,{onClick:V,type:"warning",plain:"",size:"large"},{default:m(()=>e[15]||(e[15]=[b("重置")])),_:1})])]),o("div",ee,[s(g,{data:c.value,stripe:"",style:{width:"100%"}},{default:m(()=>[s(n,{prop:"index",label:"序号",width:"50"}),s(n,{prop:"text",label:"分类",width:"180"}),s(n,{prop:"name",label:"试卷名称",width:"180"}),s(n,{prop:"total",label:"总分",width:"80"}),s(n,{prop:"passline",label:"及格线",width:"80"}),s(n,{prop:"time",label:"时长(小时)",width:"100"}),s(n,{prop:"num",label:"题目数量(个)",width:"150"}),s(n,{prop:"score",label:"分值(分)",width:"100"}),s(n,{label:"操作"},{default:m(t=>[s(d,{size:"small",type:"danger",onClick:v=>T(t.$index,t.row)},{default:m(()=>e[16]||(e[16]=[b(" 删除 ")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])])],64)}}});export{me as default};
