import{d as J,ac as Q,r as f,o as c,c as g,a as l,b as d,w as y,u as r,Q as w,R as E,e as V,F as I,ad as q,ab as $,E as H,G as L,ae as N,af as T,I as K}from"./index-BU7Eo9xm.js";/* empty css                 */import"./el-scrollbar-Cjw3bkZt.js";import{E as P,a as W}from"./el-select-kkF33hGk.js";import{f as X,b as Y}from"./request-DCHLsrwf.js";import{E as _}from"./index-CZzwatfY.js";import{E as Z}from"./index-COtfk0Lf.js";const ee={class:"topic-form"},le={class:"form"},oe={class:"opt"},te={class:"opt"},se={class:"opt"},ne={class:"opt"},ae=["onUpdate:modelValue"],ie=["onUpdate:modelValue"],re={class:"opt"},de={class:"opt"},ue={class:"opt"},pe={class:"opt"},be=J({__name:"Topic",setup(me){let t=Q({eid:"",name:"",question:"",answer:"",score:0,id:"",option:""}),k=f([]),U=f([]),C=f([]),z=f({num:0}),F=f(0),v=f([{op:"A",ov:""},{op:"B",ov:""}]),u=v.value.length-1;const A=()=>{u++,u<4&&v.value.push({op:"",ov:""}),u=u==4?4:u},S=s=>{u--,u>=0&&(u=0),v.value.splice(s,1)},B=()=>{let s=v.value;if(s&&s.length!=0){let e=[];for(let i=0;i<s.length;i++){let a={};a.key=s[i].op,a.value=s[i].ov,e.push(a)}let n=e&&JSON.stringify(e);t.option=n}},M=s=>{let e=U.value.filter(n=>n.id==s);C.value=e,t.eid=""},R=async s=>{console.log("eid:",s);let e=C.value.filter(n=>n.eid==s);e.length==1&&(z.value=e[0],t.score=e[0].score,t.name=e[0].name),s&&await q.topicNum({eid:s}).then(n=>{console.log(n);let{code:i,result:a}=n;i==200&&(F.value=a[0].total)},n=>{console.log(n)})},h=async()=>{t.eid="",t.name="",t.question="",t.answer="",t.score=0,t.option="",t.id="",v.value=[{op:"A",ov:""},{op:"B",ov:""}]},D=async()=>{let{eid:s,name:e,question:n,answer:i,score:a,option:p}=t;s&&e&&n&&i&&a&&p?q.topicAdd({eid:s,name:e,question:n,answer:i,score:a,option:p}).then(m=>{let{code:x,msg:o}=m;x==200?(h(),_.success(o)):_.error(o)},m=>{console.log(m)}):_.error("缺少参数，请重新提交")},O=async()=>{await X().then(s=>{let{code:e,msg:n,result:i}=s;if(e==200){let a=i.map((p,m)=>(p.yid=m+1,p));U.value=a}else _.error(n)})},j=async()=>{await Y().then(s=>{let{code:e,result:n}=s;if(e==200){let i=n.map(a=>(a.xid=Math.random().toString().slice(2),a));k.value=i}})};return O(),j(),(s,e)=>{const n=W,i=P,a=Z,p=$("Remove"),m=K,x=H;return c(),g(w,null,[e[17]||(e[17]=l("h3",null,"题目管理",-1)),l("div",ee,[l("div",le,[l("div",oe,[e[5]||(e[5]=l("span",{class:"label"},"考试分类:",-1)),d(i,{onChange:M,modelValue:r(t).id,"onUpdate:modelValue":e[0]||(e[0]=o=>r(t).id=o),placeholder:"选择分类",style:{width:"640px"},size:"large"},{default:y(()=>[(c(!0),g(w,null,E(r(k),o=>(c(),L(n,{key:o.xid,label:o.text,value:o.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),l("div",te,[e[6]||(e[6]=l("span",{class:"label"},"试卷名称:",-1)),d(i,{onChange:R,modelValue:r(t).eid,"onUpdate:modelValue":e[1]||(e[1]=o=>r(t).eid=o),placeholder:"选择试卷",style:{width:"640px"},size:"large"},{default:y(()=>[(c(!0),g(w,null,E(r(C),o=>(c(),L(n,{key:o.yid,label:o.name,value:o.eid},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),l("div",se,[e[7]||(e[7]=l("span",{class:"label"},"题目:",-1)),d(a,{modelValue:r(t).question,"onUpdate:modelValue":e[2]||(e[2]=o=>r(t).question=o),style:{width:"640px"},placeholder:"请输入题目",size:"large"},null,8,["modelValue"])]),l("div",ne,[e[8]||(e[8]=l("span",{class:"label top"},"选项:",-1)),l("ul",null,[(c(!0),g(w,null,E(r(v),(o,G)=>(c(),g("li",null,[N(l("input",{onInput:B,class:"op","onUpdate:modelValue":b=>o.op=b,type:"text",placeholder:"",maxlength:"1"},null,40,ae),[[T,o.op]]),N(l("input",{onInput:B,class:"ov","onUpdate:modelValue":b=>o.ov=b,type:"text",placeholder:"请输入选项"},null,40,ie),[[T,o.ov]]),d(m,{size:"large",onClick:b=>S(G)},{default:y(()=>[d(p)]),_:2},1032,["onClick"])]))),256)),l("li",null,[l("button",{class:"btn",onClick:A},"新增选项")])])]),l("div",re,[e[9]||(e[9]=l("span",{class:"label"},"答案:",-1)),d(a,{modelValue:r(t).answer,"onUpdate:modelValue":e[3]||(e[3]=o=>r(t).answer=o),style:{width:"640px"},placeholder:"请输入答案",size:"large"},null,8,["modelValue"])]),l("div",de,[e[10]||(e[10]=l("span",{class:"label"},"分值:",-1)),d(a,{modelValue:r(t).score,"onUpdate:modelValue":e[4]||(e[4]=o=>r(t).score=o),style:{width:"640px"},placeholder:"分值",size:"large"},null,8,["modelValue"])]),l("div",ue,[e[11]||(e[11]=l("span",{class:"label"},"数量信息:",-1)),e[12]||(e[12]=V(" 【 ")),l("span",null,I(r(z).num),1),e[13]||(e[13]=V(" / ")),l("span",null,I(r(F)),1),e[14]||(e[14]=V(" 】 "))]),l("div",pe,[d(x,{onClick:D,type:"primary",size:"large"},{default:y(()=>e[15]||(e[15]=[V("提交题目")])),_:1}),d(x,{onClick:h,type:"warning",plain:"",size:"large"},{default:y(()=>e[16]||(e[16]=[V("重置")])),_:1})])])]),e[18]||(e[18]=l("div",{class:"topic-list"},null,-1))],64)}}});export{be as default};
