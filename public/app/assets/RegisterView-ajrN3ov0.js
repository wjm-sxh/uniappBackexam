import{d as D,g as F,h as f,c as $,a as s,i as p,v as u,u as o,j,t as E,e as w,w as g,k as I,l as b,m as c,p as L,b as C,o as M,f as k}from"./index-BLDBbRsw.js";import{r as y}from"./request-DfzbtKw4.js";const P={class:"register"},z={class:"form"},A={class:"opt"},G={class:"opt"},H={class:"opt"},J={class:"opt"},K={class:"opt opt-2"},O={class:"opt"},Q={class:"opt"},W={class:"bottom"},ee=D({__name:"RegisterView",setup(X){const V=I(),h=()=>{V.push({path:"/home/category"})};let t=F({nickName:"",account:"",password:"",password2:"",email:""}),r=f(""),m=f("发送邮箱验证码"),d=f(60),v=!0,x=null;const R=()=>{d.value--,m.value=`${d.value}秒后重新发送`,x=setInterval(()=>{d.value--,m.value=`${d.value}秒后重新发送`,d.value==0&&(clearInterval(x),m.value="点击重新发送",v=!0,d.value=60)},1e3)},U=async()=>{let a=t.account;a.length!=0?/\w+@qq.com$/.test(a)?v&&(v=!1,R(),await y.emailSend({email:a}).then(e=>{let{msg:n}=e;b(n)})):b("邮箱格式不正确"):c("请输入账号")},S=async()=>{let a=t.account,e=r.value;if(a.length==0||e.length==0)c("输入框不能为空");else{let n=!1;if(await y.emailVerify({email:a,vcode:e}).then(i=>{let{code:l}=i;console.log(i),l==200&&(n=!0)}),n){t.email=t.account;let{account:i,password:l,email:N,nickName:_}=t;if(i&&l&&N&&_){if(t.password!=t.password2)return b("两次输入密码不一致"),!1;await y.register({account:i,password:l,email:N,nickName:_}).then(q=>{let{code:B,msg:T}=q;B==200?(L(T),setTimeout(()=>{V.replace({path:"/login"})},150)):c(T)})}else c("缺少参数,请检查再提交")}}};return(a,e)=>{const n=C("van-button"),i=C("RouterLink");return M(),$("div",P,[s("div",z,[e[12]||(e[12]=s("h4",null,"用户注册",-1)),s("div",A,[e[5]||(e[5]=s("span",{class:"label"},"昵称:",-1)),p(s("input",{"onUpdate:modelValue":e[0]||(e[0]=l=>o(t).nickName=l),type:"text",placeholder:"请输入昵称"},null,512),[[u,o(t).nickName]])]),s("div",G,[e[6]||(e[6]=s("span",{class:"label"},"账号:",-1)),p(s("input",{"onUpdate:modelValue":e[1]||(e[1]=l=>o(t).account=l),type:"text",placeholder:"请输入账号"},null,512),[[u,o(t).account]])]),s("div",H,[e[7]||(e[7]=s("span",{class:"label"},"密码:",-1)),p(s("input",{"onUpdate:modelValue":e[2]||(e[2]=l=>o(t).password=l),type:"password",placeholder:"请输入密码"},null,512),[[u,o(t).password]])]),s("div",J,[e[8]||(e[8]=s("span",{class:"label"},"确认密码:",-1)),p(s("input",{"onUpdate:modelValue":e[3]||(e[3]=l=>o(t).password2=l),type:"password",placeholder:"请确认密码"},null,512),[[u,o(t).password2]])]),s("div",K,[e[9]||(e[9]=s("span",{class:"label"},"验证码:",-1)),p(s("input",{"onUpdate:modelValue":e[4]||(e[4]=l=>j(r)?r.value=l:r=l),type:"text",placeholder:"请输入密码"},null,512),[[u,o(r)]]),s("button",{class:"btn-send",onClick:U},E(o(m)),1)]),s("div",O,[w(n,{onClick:S,class:"btn-register",type:"default"},{default:g(()=>e[10]||(e[10]=[k("注册")])),_:1})]),s("div",Q,[w(i,{to:"/login"},{default:g(()=>e[11]||(e[11]=[k("立即登录")])),_:1})])]),s("div",W,[w(n,{onClick:h,type:"default",plain:"",color:"#cccccc"},{default:g(()=>e[13]||(e[13]=[k("首页")])),_:1})])])}}});export{ee as default};
